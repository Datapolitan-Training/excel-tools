<!DOCTYPE html>
<html>
  <head>
    <title>Excel Tools: Summarizing Data - NYC DCAS</title>
    <meta charset="utf-8">
    <link rel="stylesheet" href="slide.css">
  </head>
  <body>
    <textarea id="source">

layout:true

<p class="footer">
<span xmlns:dct="http://purl.org/dc/terms/" property="dct:title">Excel Tools: Summarizing Data - Additional Materials</span> by <a xmlns:cc="http://creativecommons.org/ns#" href="http://www.datapolitan.com" property="cc:attributionName" rel="cc:attributionURL">Richard Dunks</a> is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.<a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative-Commons-License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
</p>
---

class:center, middle
![img-center-50](images/datapolitan.png)

# Excel Tools: Summarizing Data 

- - -

## Instructors: Richard Dunks and Julia Marden
### Follow along at: http://bit.ly/excel-tools

#### See the code at: http://bit.ly/excel-tools-code

---

class:center,middle
# Welcome

---

# Data Driven Culture
![img-center-90](images/ddc_compass.png)

---

# Introduce Yourself to Your Neighbor
+ Who are you?
+ Where do you work?
+ What has been the proudest moment in your job?

---

# What to Expect Today
+ 9:45 – Review of Basic Operations
+ 10:30 – 15 min break
+ 10:45 – Exploratory Analysis and Basic Summarization
+ 12:00 – Lunch
+ 1:00 – Visualizing Data in Excel
+ 2:00 – More Functions in Excel
+ 2:30 – 15 min break
+ 2:45 – Advanced Excel Functionality
+ 4:30 – Dismissal

---

# Housekeeping
--

+ We’ll have one 15 minute break in the morning
--

+ We’ll have an hour for lunch
--

+ We’ll have a 15 minute break in the afternoon
--

+ Class will start promptly after breaks
--

+ Feel free to use the bathroom if you need during class
--

+ Please take any phone conversations into the hall to not disrupt the class

???
+ Set expectations for the class

---

# Getting Started
+ What are spreadsheets?
+ Why do we use them?

???
+ Get students thinking about what operations spreadsheets enable
+ Understand how spreadsheets differ from other office applications

---

class:center,middle
# Overview of Excel

---

# Benefits of Excel
--

+ Easy to use
--

+ Very visual
--

+ Lots of features and functions
--

+ Easy to make charts
--

+ Does a lot of formatting for you

???
+ Poll class for their key challenges working with Excel
+ Discuss the ways in which Excel is beneficial in daily work

---

# Drawbacks of Excel
--

+ Not very intuitive
--

+ Hard to find what you’re looking for (and they keep moving things around)
--

+ Lots of features and functions
--

+ Easy to make (bad) charts
--

+ Does a lot of formatting for you

???
+ Poll class for their key challenges working with Excel
+ Discuss the ways in which Excel is challenging in their daily work

---

# Cautionary Tale - Austerity in Europe
![img-center-80](images/athensprotest.jpg)
.caption[Image Credit: [http://underclassrising.net](https://www.flickr.com/photos/0742/4163565280), [CC BY-SA 2.0](https://creativecommons.org/licenses/by-sa/2.0/)]

---

# Cautionary Tale - Austerity in Europe
![img-center-60](images/reinhart_rogoff_coding_error.png)
Source: Mike Konczal, "[Researchers Finally Replicated Reinhart-Rogoff, and There Are Serious Problems](http://rooseveltinstitute.org/researchers-finally-replicated-reinhart-rogoff-and-there-are-serious-problems/)"

---

# To Err is Human

> Since 1995, 88% of the 113 spreadsheets audited in 7 studies ... have contained errors.

## - Raymond Panko, "[What We Know About Spreadsheet Errors](http://panko.shidler.hawaii.edu/My%20Publications/Whatknow.htm)"
???
+ An example of how common Excel errors can have a real-world impact

???
+ Contextualize occurance of errors (they happen alot)
+ Instill expectation that errors will happen and to be aware (they will happen to you)

---

exclude:true
class:center,middle
# 88% of Spreadsheets Have Errors

Source: [Market Watch](http://www.marketwatch.com/story/88-of-spreadsheets-have-errors-2013-04-17)

---

# Some Common Excel Shortcuts
--

+ `Ctrl + arrow key` - Go to the end of the text in that direction
--

+ `Ctrl + c` - Copy the selection to clipboard
--

+ `Ctrl + v` - Paste clipboard contents to the cell(s)
--

+ [Click for more shortcuts](http://office.microsoft.com/en-us/excel-help/keyboard-shortcuts-in-excel-2010-HP010342494.aspx)

???
+ Introduce key shortcuts to make analysis more efficient
+ Emphasize that these are optional but helpful

---

class:center,middle
# Let's Get Started
## [Click to download our data](data/InventoryExample.xlsx)

---

# Writing Simple Formulas
![img-center-100](images/inv_form1.png)

---

# Writing Simple Formulas
![img-center-100](images/inv_form2.png)

---

# Writing Simple Formulas
![img-center-100](images/inv_form3.png)

---

# Writing Simple Formulas
![img-center-100](images/inv_form4.png)

---

# Writing Simple Formulas
![img-center-100](images/inv_form5.png)

---

# Writing Simple Formulas
![img-center-100](images/inv_form6.png)

---

# Writing Simple Formulas
![img-center-100](images/inv_form7.png)

---

# Writing Simple Formulas
![img-center-100](images/inv_form8.png)

---

class:center,middle
# Excel Functions
## [More on Functions from Microsoft](http://office.microsoft.com/en-us/excel-help/excel-functions-by-category-HP010342656.aspx)

---

# Basic Function Syntax
```
=FUNCTION_NAME(parameter1, parameter2,...)
```

--
## For Example
```
=SUM(A5:A8)
```
--
+ This tells Excel to sum all the values in cells A5, A6, A7, and A8

---

# SUM Function
![img-center-100](images/ex1_sum.png)

---

# COUNT Function
![img-center-100](images/ex1_count1.png)


---

# COUNT Function
![img-center-100](images/ex1_count2.png)


---

# Calculate Discount
![img-center-100](images/ex1_calc_disc1.png)

---

# Calculate Discount
![img-center-100](images/ex1_calc_disc2.png)

---

# SUM Function with Negative Numbers
![img-center-100](images/ex1_sum_nn1.png)

---

# SUM Function with Negative Numbers
![img-center-100](images/ex1_sum_nn2.png)

---

# Functions in Excel
--

+ Allow you to do calculations in Excel
--

+ Also allow you to manipulate text
--

+ And a whole lot more...

---

# Some Categories of Functions in Excel
--

+ Database functions
--

+ Date and time functions
--

+ Financial functions
--

+ Logical functions
--

+ Lookup and reference functions
--

+ Math and trigonometry functions
--

+ Statistical functions
--

+ Text functions
--

+ 13 categories in total

---

class:center,middle
# Let's Tell the Story of NYC between 1970 and 2010
## [Click to download the data](data/NYC_Population_1970-2010.xlsx)

---

# Calculating Total Borough Population
![img-center-100](images/total_boro_pop1.png)

---

# Calculating Total Borough Population
![img-center-100](images/total_boro_pop2.png)
--

+ Copy and paste the formula for each decade
--

+ .red[Can we paste the same formula for all boroughs?]

---

# Calculating Population Change Each Decade
![img-center-100](images/boro_pop_change1.png)

---

# Calculating Population Change Each Decade
![img-center-100](images/boro_pop_change2.png)
--

+ Copy and paste the formula for each decade starting with 1980 and each borough

---

# Calculating Percentage Change Each Decade
![img-center-100](images/perc_change1.png)

---

# Calculating Percentage Change Each Decade
![img-center-100](images/perc_change2.png)

---

# Display Population Change Over Time
![img-center-100](images/cd_graph1.png)

---

# Display Population Change Over Time
![img-center-90](images/cd_graph2.png)

---

# Display Population Change Over Time
![img-center-100](images/cd_graph3.png)

---

# Display Population Change Over Time
![img-center-60](images/cd_graph4.png)

---

# Display Population Change Over Time
![img-center-85](images/cd_graph5.png)

---

# Display Population Change Over Time
![img-center-60](images/cd_graph6.png)

---

class:center,middle
# 15 Minute Break

---

# Exploratory Data Analysis
--

+ Goal -> Discover patterns in the data
--

+ Understand the context
--

+ Summarize fields
--

+ Use graphical representations of the data
--

+ Explore outliers

--

####Tukey, J.W. (1977). Exploratory data analysis. Reading, MA: Addison-Wesley

---

class:center,middle
# Looking at Noise in New York City
## [Click to download the data](data/NYC_Population_1970-2010.xlsx)

---

# Filtering
![img-center-100](images/filtering1.png)

---

# Filtering
![img-center-40](images/filtering2.png)

---

# Conditional Formatting
![img-center-65](images/cf1.png)

---

# Conditional Formatting
![img-center-80](images/cf2.png)

---

# PivotTables
--

+ A data summarization tool
--

+ Useful to quickly understand data
--

+ Can use to graph data totals
--



![img-center-100](images/pt1.png)

---

# Creating a PivotTable
![img-center-60](images/pt2.png)
--

+ Should default to all your data .red[unless you have any cells selected]
--

+ Should default to a new worksheet

---

# Creating a PivotTable
![img-right-40](images/pt3.png)
## Drag and drop fields to visualize
+ Row labels 
+ Values
+ Filter
+ Column Labels

---

# Creating a PivotTable
![img-center-100](images/pt4.png)

---

# Your Turn
+ In your groups, explore the complaints for your assigned borough
+ What are the common types of complaints?
+ Which Community Districts have the most complaints?
+ Identify any other meaningful patterns to the noise complaints

---

# NYC Community Districts

![img-center-65](images/cd_map.png)
.caption[Image Credit: Datapolitan [CC BY-SA 4.0](http://creativecommons.org/licenses/by-sa/4.0/)]


---

class:center,middle
# Lunch

---

class:center,middle
# Welcome Back!

---

class: middle, center
# 15 Min Break

---

# Datasets for Class
+ [Inventory Example](data/InventoryExample.xlsx)
+ [NYC Population Data, 1970-2010](data/NYC_Population_1970-2010.xlsx)
+ [311 Noise Complaints, 1 June - 30 August 2015](data/311_Noise_20150601_20150830.csv)

---

# Key Excel Functions for Summarizing Data
+ [`=SUM()`](https://support.office.com/en-us/article/SUM-function-043e1c7d-7726-4e80-8f32-07b23e057f89): Calculates the sum for a range of numbers
+ [`=COUNT()`](https://support.office.com/en-us/article/COUNT-function-a59cd7fc-b623-4d93-87a4-d23bf411294c): Counts the number of cells containing numbers in a range
+ [`=COUNTA()`](https://support.office.com/en-us/article/COUNTA-function-7dc98875-d5c1-46f1-9a82-53f3219e2509): Counts the number of non-blank cells in a range
+ [`=HOUR()`](https://support.office.com/en-us/article/HOUR-function-a3afa879-86cb-4339-b1b5-2dd2d7310ac7): Extracts the hour from a timestamp
+ [`=WEEKDAY()`](https://support.office.com/en-us/article/WEEKDAY-function-60e44483-2ed1-439f-8bd0-e404c190949a): Extracts the day of the week from a timestamp
+ [`=CHOOSE()`](https://support.office.com/en-us/article/CHOOSE-function-FC5C184F-CB62-4EC7-A46E-38653B98F5BC): Uses an index number to return a result from an ordered list of values

---

# Key Excel Functions for Summarizing Data
+ [`=MID()`](https://support.office.com/en-us/article/MID-MIDB-functions-d5f9e25c-d7d6-472e-b568-4ecb12433028): Select a specified number of characters from a text string
+ [`=LEFT()`](https://support.office.com/en-us/article/LEFT-LEFTB-functions-9203d2d2-7960-479b-84c6-1ea52b99640c): Select a specified number of characters from the beginning of a text string
+ [`=RIGHT()`](https://support.office.com/en-us/article/RIGHT-RIGHTB-functions-240267ee-9afa-4639-a02b-f19e1786cf2f): Select a specified number of characters from the end of a text string
+ [`=FIND()`](https://support.office.com/en-us/article/FIND-FINDB-functions-c7912941-af2a-4bdf-a553-d0d89b0a0628): Find the location of a given character in a text string

---

# Key Excel Functions for Summarizing Data
+ [`=CONCATENATE()`](https://support.office.com/en-us/article/CONCATENATE-function-8f8ae884-2ca8-4f7a-b093-75d702bea31d): Combine characters together into a text string
+ [`=VLOOKUP()`](https://support.office.com/en-us/article/VLOOKUP-function-0bbc8083-26fe-4963-8ab8-93a18ad188a1): An operation to look up a value in another location based on an index value 
+ [`=IF()`](https://support.office.com/en-us/article/IF-function-69aed7c9-4e8a-4755-a9bc-aa8bbff73be2): A function for logical comparison between values to return a desired result given a particular condition


---

# Formulas for Class
+ Formula to concatenate Community District and Borough
```
=CONCATENATE(IF(A3<10,"0",""),A3," BRONX")
```
+ Formula for VLOOKUP of Community District Population (may need to adjust references)
```
=VLOOKUP(A5,'[NYC_Population_1970-2010.xlsx]A'!$B$1:$H$81,7,FALSE)
```

---

# Have trouble with the analysis?
+ [Inventory Example with Formulas](data/InventoryExample_with_Formulas.xlsx)
+ [NYC Population, 1970 - 2010 with calculations](data/NYC_Population_1970-2010_calculated.xlsx)


---

# Resources
+ [NYC Open Data Portal](https://data.cityofnewyork.us/)
+ [Center for Government Excellence](http://govex.jhu.edu/) [Data Science Cheatsheet](https://github.com/govex/Data-Science)
+ [Data Sensemaking](http://fellinlovewithdata.com/teaching/developing-a-data-sensemaking-course) by Enrico Bertini

---

# Contact Information
## Richard Dunks
+ Email: richard[at]datapolitan[dot]com
+ Blog: http://blog.datapolitan.com
+ Twitter: [@datapolitan](https://twitter.com/datapolitan)

## Julia Marden
+ Email: julia[at]tinypanther[dot]com
+ Website: http://tinypanther.com
+ Twitter: [@juliaem](https://twitter.com/juliaem)

---

class:center, middle
#THANK YOU!
    </textarea>
    <script src="https://gnab.github.io/remark/downloads/remark-latest.min.js">
    </script>
    <script>
      var slideshow = remark.create(
        // {
        //   slideNumberFormat: ""}
        );
    </script>
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-55673554-2', 'auto');
  ga('send', 'pageview');

</script>
  </body>
</html>